# Ref: https://docs.ansible.com/ansible/latest/collections/ansible/builtin/package_module.html
#         https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html
#         https://docs.ansible.com/ansible/latest/collections/community/general/pacman_module.html


---
#  ***** ***** Distro: Debian and Module: apt ***** *****

# run the equivalent of "apt-get update"
#   only run "update_cache=yes" if the last one is more than 3600 seconds ago
- name: pre-run | update package cache (debian based distros)
  tags: always
  apt:
    update_cache: yes
    cache_valid_time: 3600
  changed_when: False
  # when: ansible_distribution in ["Debian", "Pop!_OS", "Ubuntu", "Kali GNU/Linux"]
  when: ansible_os_family == "Debian"


#  ***** ***** Distro: RedHat and Module: yum ***** *****

- name: pre-run | update package cache (RedHat based distros)
  tags: always
  yum:
    update_cache: yes
  changed_when: False
  # when: ansible_distribution in ["RedHat", "centos", "fedora"]
  when: ansible_os_family == "RedHat"


#  ***** ***** Distro: Archlinux and Module: pacman ***** *****

- name: pre-run | update package cache (arch)
  tags: always
  pacman:
    update_cache: yes
  changed_when: False
  # when: ansible_distribution == "Archlinux"
  when: ansible_os_family == "Archlinux"
